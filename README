Problem description in russian:
http://mit.spbau.ru/sewiki/images/1/18/Java_hmw_7.pdf